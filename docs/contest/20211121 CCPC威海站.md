# [CCPC威海站]()

| 排名   | 当场过题数 | 至今过题数 | 总题数 |
| ------ | ---------- | ---------- | ------ |
| 22/240 | 8          | 8          | 13     |

## **A**

**solved by JLK**

### 题意

签到，略

### 题解



## **B**

**upsolved by **

### 题意



### 题解



## **C**

**upsolved by **

### 题意



### 题解



## **D**

**solved by YZW**

### 题意

给出一个字符串 $S$，有 $q$ 组询问，每组询问给出下标 $i$，问将 $S[i]$ 置为 `#` 后有多少个不同的周期。

$1\leq |S|,q \leq 10^6$

### 题解

若 $S[1:r]$ 为原串的一个 border，则当 $r<i\leq |S|-r$ 时 border 对应一个周期。

KMP 求出所有 border，将区间加法差分为 $+1,-1$ 再前缀和即可 $O(1)$ 回答询问。

时间复杂度 $O(|S|+q)$。

## **E**

**solved by YZW**

### 题意

有 $n$ 首曲子，系统从中随机选取两首不同的曲子给你打，打第 $i$ 首曲子得分 $a_i$。你有至多 $k$ 次机会选择重抽，问最优方案下的期望得分。

额外给出 $q$ 个 case，问抽到第 $x,y$ 首曲子还有 $c$ 次重抽机会时，直接开打和重抽哪个更优，二者期望得分相差 $10^{-4}$ 时视为同样优。

$2\leq n\leq 10^5$，$1\leq q\leq 10^5$，$1\leq k\leq 100$，$0\leq a_i\leq 10^6$，$1\leq x<y\leq n$，$0\leq c\leq k$。

### 题解

设 $f(c)$ 表示还有 $c$ 次重抽机会时期望得分，容易写出：

$$f(0)={2\over n(n-1)}\sum_{i=1}^n (n-1)a_i$$

$$f(c)={2\over n(n-1)}\sum_{i=1}^n\sum_{j=1}^n \max\{a_i+a_j,f(c-1)\}\qquad (c>0)$$

对排序后的 $\{a_i\}$ 双指针即可求出 $a_i+a_j$ 的 $(i,j)$ 对数量与贡献和，从而可以计算 $f(0),\dots,f(k)$。

对于 $q$ 个 case，将 $a_x+a_y$ 与 $f(c-1)$ 比较即可。需要注意 $c=0$ 时只能直接开打。

## **F**

**solved by YZW**

### 题意



### 题解



## **G**

**solved by TYB**

### 题意



### 题解



## **H**

**solved by TYB**

### 题意



### 题解



## **I**

**upsolved by **

### 题意



### 题解



## **J**

**solved by YZW**

### 题意

签到，略。

### 题解



## **K**

**upsolved by **

### 题意



### 题解



## **L**

**upsolved by **

### 题意



### 题解



## **M**

**solved by JLK**

### 题意

长度为$n$的01串，有$m$个1，并且最长连续1的长度恰好为$k$的方案数。

$0 \le n,m,k \le 10^5$​

### 题解

先把一些特殊情况判掉。

考虑算出最长连续1长度$\ge k$和$\ge k+1$的，然后相减得到答案。

对于$\ge k$，可以用经典容斥，枚举$\ge k$的段数。只需要让我们选出的连续1段不相邻即可，就是在中间插0。用隔板法可以得到$\ge k$的答案为：

$\sum\limits_{i=1}^{\lfloor\frac{n}{k}\rfloor}C_{n-m+1}^i\times C_{(n-m)+(m-ik)}^{m-ik}$


就可以直接算了。$O(\frac {n} {k})$

## **记录**

开局JLK过A(0:07)，YZW过J(0:21)和D(0:36)。

先跟榜看M，没想到，扔了。

然后看G，推了个式子但是不会求。后来TYB想到根号就过了(1:15)。

YZW和TYB讨论后上手写E，JLK看M。

E WA一次，打印了代码后JLK写M。

M WA一次，E改了两个错误，还是WA。

M改了一个long long又RE了，修了一下边界条件（越界）就过了(2:07)。

继续改E，然后过了(2:22)。

然后看H，TYB马上想到了网络流，写完交上去T了。

JLK觉得Dinic板子不行，加了一些优化，但是本地不会造数据，测不出时间，就没交。

然后JLK想了个$O(n^3)$的树形DP，调了一年没调出来。

YZW和TYB讨论出了F，上来写过了F(4:28)。

H还是没调出来，最后十分钟把改过的网络流交上去就过了(4:49)。

## **总结**

JLK：建议把所有板子整个最快的备用（。计数题一定要注意检查ll和组合数的数组越界。

## **Dirt**

E(-2)

H(-1)

M(-2)
